@model IEnumerable<CountryListDto>
@{
    ViewData["Title"] = "مدیریت کشورها";
}
<style>
    tr th {
        text-align: center !important;
    }
</style>

<div class="card-body">
    <div>
        <a class="btn btn-primary" data-toggle="modal" asp-area="AdminPanel" asp-controller="Country" asp-action="CreateCountry"
           data-target="#modal-action-country" id="add-country">
            <i class="fa fa-plus"></i>
            <span>افزودن  کشور</span>
        </a>
    </div>

    <table class="table table-striped table-sm  table-hover mt-3 text-center ">
        <thead>
            <tr>

                <th>ردیف</th>
                <!-- Html Helper for dynamic implementing the property titles of the table(class= @@model IEnumerable<BookGroup>)-->
                <th>@Html.DisplayNameFor(model => model.Name)</th>
                <th>@Html.DisplayNameFor(model => model.Description)</th>

                <th>عملیات</th>
            </tr>
        </thead>
        <tbody>
            @{
                int counter = 1;
            }
            @foreach (var item in Model)
            {
                <tr>
                    <td>@(counter++)</td>

                    <td>@item.Name</td>

                    <td>@item.Description</td>



                    <td class="align-middle">
                        <div class="dropdown dropright ">
                            <a class="fa fa-spin " aria-haspopup="true" aria-expanded="false" data-toggle="dropdown">
                                <i class="fa fa-cog  fa-spin"></i>
                            </a>
                            <div class="dropdown-menu justify-content-center">
                                <a class="text-info  dropdown-item" data-toggle="modal" id="show-edit-book" asp-action="EditBook"
                                   data-target="#modal-action-country" asp-route-id="@item.Id">
                                    <i class="p-1 fa fa-pencil"></i>
                                    <span>ویرایش</span>
                                </a>

                                <div class="dropdown-divider"></div>

                                <a class="text-danger dropdown-item" data-toggle="modal" id="show-delete-book" asp-action="DeleteBook"
                                   data-target="#modal-action-country" asp-route-id="@item.Id">
                                    <i class="p-1 fa fa-trash"></i>
                                    <span>حذف</span>
                                </a>
                            </div>
                        </div>
                    </td>
                </tr>
            }

        </tbody>
    </table>


</div>
<partial name="~/Views/Shared/Partials/Modal/_ModalPartial.cshtml" model='new BootstrapModel { Id ="modal-action-country", Size=ModalSize.Large }' />
@*@await Html.PartialAsync("~/Views/Shared/Partials/Modal/_ModalPartial.cshtml", new BootstrapModel { Id = "modal-action-country", Size = ModalSize.Large })*@

@section panelScript{

    <script>
        //آپلود فایل
        var UploadImage = function (inputId) {

            var data = new FormData;
            var file;

            //همه فایل های داخل اینپوت فایل را  دریافت میکند
           file = $(inputId).prop("files");

            //اضافه کردن فایل ها به متغیر برای ارسال به اکشن
            for (var i = 0; i < file.length; i++) {
                data.append('files', file[i]);
            }

            $.ajax({
                type: "post",
                url: '@Url.Action("UploadFile","Country", new { area = "AdminPanel"})',
                data: data,
                contentType: false,
                processData: false,
                dataType: "json",
                success: function(result){

                }
            }).done(function (result) {
                if (result.status == "success") {

                    //برای نمایش تصویر کاربر
                    //دریافت نام تصویر آپلود شده
                    $("#imgindex").attr('src', "\\upload\\indexImage\\" + result.imageName);

                    $("#divmessage").removeClass('hidden');
                    $("#divmessage").text("تصویر با موفقیت آپلود شد");

                    //ذخیره نام تصویر در تگ و پراپرتی جدول خبر
                    $("#IndexImage").val(result.imageName);
                }
            }).fail(function (result) {
                if (result.status != "success") {
                    $("#divmessage").removeClass('hidden');
                    $("#divmessage").text("در هنگام آپلود مشکلی رخ داد");

                }
            });
        };
    </script>
}

















@*<script>
            $(document).ready(function () {
                /*اسکریپت مودال یا تب های مرحله ای*/
                var currentTab = 0; // Current tab is set to be the first tab (0)
                $("#add-country").click(function () {

                showTab(currentTab); // Display the current tab



                $("#nextBtn,#prevBtn").click(function () {
                    var e=$(this).attr("data-click-id");
                    nextPrev(e); // Display the current tab
                });
                function showTab(n) {
                    // This function will display the specified tab of the form ...
                    var x = $(".modal-bocy>div.tab");
                    x.eq(n).removeClass("d-none").addClass("d-block");
                    // ... and fix the Previous/Next buttons:
                    if (n == 0) {
                        $("#prevBtn").removeClass("d-inline-block").addClass("d-none");
                    }
                    else {
                        $("#prevBtn").removeClass("d-none").addClass("d-inline-block");
                    }
                    if (n == (x.length - 1)) {
                        $("#nextBtn").html("اقزودن کشور");
                    } else {
                        $("#nextBtn").html("بعدی");
                    }
                    // ... and run a function that displays the correct step indicator:
                    fixStepIndicator(n)
                };

                function nextPrev(n) {
                    // This function will figure out which tab to display
                    var x = $(".tab");

                    //برای  اینگه اگر ولیدیشن چکبود مرحله بعد نرود
                    // Exit the function if any field in the current tab is invalid:
                  //  if (n == 1 && !validateForm()) return false;

                    // Hide the current tab:
                    x.eq(currentTab).removeClass("d-block").addClass("d-none");
                    // Increase or decrease the current tab by 1:
                    currentTab = currentTab + n;
                    // if you have reached the end of the form... :
                    if (currentTab >= x.length) {
                        //...the form gets submitted:
                       $("#regForm").submit();
                        return false;
                    }
                    // Otherwise, display the correct tab:
                    showTab(currentTab);
                };
                //متد چک کردن ورودی ها
                //function validateForm() {
                //    // This function deals with validation of the form fields
                //    var x, y, i, valid = true;
                //    x = document.getElementsByClassName("tab");
                //    y = x[currentTab].getElementsByTagName("input");
                //    // A loop that checks every input field in the current tab:
                //    for (i = 0; i < y.length; i++) {
                //        // If a field is empty...
                //        if (y[i].value == "") {
                //            // add an "invalid" class to the field:
                //            y[i].className += " invalid";
                //            // and set the current valid status to false:
                //            valid = false;
                //        }
                //    }
                //    // If the valid status is true, mark the step as finished and valid:
                //    if (valid) {
                //        document.getElementsByClassName("step")[currentTab].className += " finish";
                //    }
                //    return valid; // return the valid status
                //}



                function fixStepIndicator(n) {
                    // This function removes the "active" class of all steps...
                    var i, x = $(".step");
                    x.each(function () {
                       x.removeClass("active");
                    });
                    //for (i = 0; i < x.length; i++) {
                    //    x[i].className = x[i].className.replace(" active", "");
                    //}
                    //... and adds the "active" class to the current step:
                    x.eq(n).addClass(" active");
                    };

                });
    });
        </script>*@




